select *from pei.dimensiones d where d.dim_codigo =1;
select *from control_estados.estados_dimensiones ed ;

select *from pei.objetivos_estrategicos oe where oe.dim_codigo=1;
select *from control_estados.estados_objetivos_estrategicos eoe ;

select *from pei.estrategias e where e.oes_codigo =17;
select *from control_estados.estados_estrategias ee;
select *from control_estados.flujos_tablas where tab_codigo =53;
select *from parametricas.

select *from pei.acciones_estrategicas ae where ae.est_codigo  =11;
select *from control_estados.estados_acciones_estrategicas eae;



select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo =20;
select *from control_estados.estados_acciones_estrategicas_gestiones eaeg;


-- ################## PEI 2021 2025a####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =3;
select *from pei.dimensiones d where d.pei_codigo =3;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (7);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (16);
select *from pei.estrategias e where e.oes_codigo in (16);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (11);


-- ################## PEI prueba 8####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =12;
select *from pei.dimensiones d where d.pei_codigo =12;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (22);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (40);
select *from pei.estrategias e where e.oes_codigo in (40);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (47);


-- ################## PEI prueba 7####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =11;
select *from pei.dimensiones d where d.pei_codigo =11;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (21);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (37);
select *from pei.estrategias e where e.oes_codigo in (37);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (40);

select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (24);

-- ################## PEI dfads####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =15;

-- ################## PEI yhamil 7 de junio####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =16;
select *from pei.dimensiones d where d.pei_codigo =16;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (27,28,29);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (41,44,47,42,45,48,43,46);
select *from pei.estrategias e where e.oes_codigo in (41,44,47,42,45,48,43,46);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (48,49);

select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (66,67);

SELECT 
        t.est_codigo,
        t.oes_codigo,
        oe.oes_descripcion,
        t.est_numero,
        t.est_descripcion,
        t.est_estado,
        e.est_color, 
        e.est_nombre AS est_estado_descripcion,
        TO_CHAR(t.fecha_registro, 'HH24:MI am dd/mm/yyyy') as fecha_registro 
      FROM pei.estrategias t
      LEFT JOIN parametricas.estados e ON e.est_codigo = t.est_estado
      LEFT JOIN pei.objetivos_estrategicos oe ON oe.oes_codigo = t.oes_codigo
      WHERE TRUE
      AND t.est_codigo IN (undefined)
      
      
      AND t.est_descripcion IN ('estrategia prueba 8 yhamil')
      AND t.est_estado IN (1,2,0)
      ORDER BY t.est_codigo ASC;


-- ################## PEI 23 de junio####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =10;
select *from pei.dimensiones d where d.pei_codigo =10;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (17,18);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (33,34);
select *from pei.estrategias e where e.oes_codigo in (33,34);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (38,39);


-- ################## PEI 29 de junio####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =21;
select *from pei.dimensiones d where d.pei_codigo =21;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (61);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (66);
select *from pei.estrategias e where e.oes_codigo in (66);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (73);
select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (23);

select *from pei.programas p where p.pro_codigo =10;

-- ################## PEI 30 de junio####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =21;
select *from pei.dimensiones d where d.pei_codigo =21;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (61);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (66);
select *from pei.estrategias e where e.oes_codigo in (66);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (73);
select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (23);

select *from pei.programas p where p.pro_codigo =10;

SELECT 
	DISTINCT 
	pei.pei_descripcion, 
	pei.ges_codigo_inicio,
	pei.ges_codigo_final,
	aeg.ges_codigo,
	g2.ges_anio AS ges_anio_inicio, 
	g3.ges_anio AS ges_anio_final, 
	g1.ges_anio AS ges_anio_aeg 
FROM pei.acciones_estrategicas_gestiones aeg 
INNER JOIN pei.acciones_estrategicas ae ON ae.aes_codigo = aeg.aes_codigo 
INNER JOIN pei.estrategias e ON e.est_codigo = ae.est_codigo 
INNER JOIN pei.objetivos_estrategicos oe ON oe.oes_codigo = e.oes_codigo 
INNER JOIN pei.dimensiones d ON d.dim_codigo = oe.dim_codigo 
INNER JOIN pei.plan_estrategico_institucional pei ON pei.pei_codigo = d.pei_codigo 
INNER JOIN parametricas.gestiones g1 ON g1.ges_codigo = aeg.ges_codigo 
INNER JOIN parametricas.gestiones g2 ON g2.ges_codigo = pei.ges_codigo_inicio 
INNER JOIN parametricas.gestiones g3 ON g3.ges_codigo = pei.ges_codigo_final 
WHERE pei.pei_codigo = 5;



-- ################## PEI 22 de junio####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =6;
select *from pei.dimensiones d where d.pei_codigo =6;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (10,11);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (19,20,21,22);
select *from pei.estrategias e where e.oes_codigo in (19,20,21,22);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (14,15,16,17);

select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (24);
-- ################## PEI prueba 5####################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =7;
select *from pei.dimensiones d where d.pei_codigo =7;
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (12);
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (23);
select *from pei.estrategias e where e.oes_codigo in (23);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (18);

select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (30);








select *from pei.estrategias e where e.oes_codigo in (1,2,3,4,5,6,7,15);
select *from pei.acciones_estrategicas ae where ae.est_codigo in (1,2,3,4,10);
select *from pei.plan_estrategico_institucional pei ;
select *from control_estados.estados_planes_estrategicos_institucionales epei ;
--######################### ESTADOS ORG 2 #######################
select *from estructura_organizacional.areas_unidades au where au.aun_nombre ='prueba - p';


select *from estructura_organizacional.areas_unidades ae where ae.org_codigo =2 and ae.aun_sigla ='P';
select *from estructura_organizacional.areas_unidades_dependencias aud where aud.aun_codigo_hijo =43;
select *from estructura_organizacional.autoridades_funcionales af where af.aun_codigo_supervisado =43;

--######################### ESTADOS ORG 5 #######################
select *from estructura_organizacional.areas_unidades ae where ae.org_codigo =5;
select *from estructura_organizacional.areas_unidades_dependencias aud where aud.aun_codigo_hijo =79;
select *from estructura_organizacional.autoridades_funcionales af where af.aun_codigo_supervisado =79;


--######################### ESTADOS dfads #######################
select *from pei.plan_estrategico_institucional pei where pei.pei_codigo =15;
select *from pei.dimensiones d where d.pei_codigo =15;--no tiene
select *from pei.objetivos_estrategicos oe where oe.dim_codigo in (10,11);--no tiene
select *from pei.objetivos_estrategicos oe where oe.oes_codigo in (19,20,21,22);--no tiene
select *from pei.estrategias e where e.oes_codigo in (19,20,21,22);--no tiene
select *from pei.acciones_estrategicas ae where ae.est_codigo in (14,15,16,17);--no tiene

select *from pei.acciones_estrategicas_gestiones aeg where aeg.aes_codigo in (24);--no tiene

--###########################################
      SELECT 
        t.ges_codigo,
        t.ges_anio,
        t.ges_descripcion, 
        t.ges_estado,
        go2.gor_codigo,
        e.est_color, 
        e.est_nombre AS ges_estado_descripcion,
        TO_CHAR(t.fecha_registro, 'HH24:MI am dd/mm/yyyy') as fecha_registro
      FROM parametricas.gestiones t
      LEFT JOIN parametricas.estados e ON e.est_codigo = t.ges_estado
      INNER JOIN estructura_organizacional.gestiones_organigramas go2 ON go2.ges_codigo  = t.ges_codigo
      ORDER BY t.ges_anio ASC;
     SELECT CURRENT_DATE;
    
     select * from parametricas.gestiones g 
        where g.ges_anio = 2024 or g.ges_anio = 2025 ;
     
select
	coalesce(MAX(p.pei_codigo),
	0) + 1 codigo
from
	pei.plan_estrategico_institucional p;

--############# organigrama 30 de junio ##############
select *from estructura_organizacional.areas_unidades au where au.aun_codigo =89;
select *from estructura_organizacional.areas_unidades_dependencias aud where aud.aun_codigo_padre =89;

select *from estructura_organizacional.areas_unidades au where au.aun_codigo in (90,91,96,97);

--############# organigrama 31 de junio ##############
select *from estructura_organizacional.areas_unidades au where au.aun_codigo =100;
select *from estructura_organizacional.areas_unidades_dependencias aud ;


select *from estructura_poa.actividades a where a.act_codigo =9;








